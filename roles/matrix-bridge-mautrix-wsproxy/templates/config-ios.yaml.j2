#jinja2: lstrip_blocks: "True"
# Homeserver details.
homeserver:
    # The address that this appservice can use to connect to the homeserver.
    address: {{ matrix_mautrix_wsproxy_homeserver_address }}
    websocket_proxy: {{ matrix_mautrix_wsproxy_appservice_websocket }}
    # The domain of the homeserver (for MXIDs, etc).
    domain: {{ matrix_mautrix_wsproxy_homeserver_domain }}
# Application service host/registration related details.
# Changing these values requires regeneration of the registration.

appservice:
    # SQLite database path
    database: mautrix-imessage.db

    # The unique ID of this appservice.
    id: imessage
    # Appservice bot details.
    bot:
        # Username of the appservice bot.
        username: imessagebot
        # Display name and avatar for bot. Set to "remove" to remove display name/avatar, leave empty
        # to leave display name/avatar as-is.
        displayname: iMessage bridge bot
        avatar: mxc://maunium.net/tManJEpANASZvDVzvRvhILdX

    # Authentication tokens for AS <-> HS communication. Autogenerated; do not modify.
    as_token: "{{ matrix_mautrix_wsproxy_appservice_token }}"
    hs_token: "{{ matrix_mautrix_wsproxy_homeserver_token }}"
imessage:
    platform: ios

# Bridge config
bridge:
    # The user of the bridge.
    user: "{{ matrix_mautrix_imessage_user }}"

    # Localpart template of MXIDs for iMessage users.
    # {{ '{{.}}' }} is replaced with the phone number or email of the iMessage user.
    username_template: "{{ 'imessage_{{.}}' }}"
    # Displayname template for iMessage users.
    # {{ '{{.}}' }} is replaced with the contact list name (if available) or username (phone number or email) of the iMessage user.
    displayname_template: "{{ '{{.}} (iMessage)' }}"

    # Whether or not the bridge should send a read receipt from the bridge bot when a message has been
    # sent to iMessage. If fetch_message_on_timeout is enabled, a successful post-timeout fetch will
    # trigger a read receipt too.
    delivery_receipts: false

    # Whether or not to update the m.direct account data event when double puppeting is enabled.
    # Note that updating the m.direct event is not atomic (except with mautrix-asmux)
    # and is therefore prone to race conditions.
    sync_direct_chat_list: false
    # Shared secret for https://github.com/devture/matrix-synapse-shared-secret-auth
    #
    # If set, custom puppets will be enabled automatically for local users
    # instead of users having to find an access token and run `login-matrix`
    # manually.
    login_shared_secret: {{ matrix_mautrix_whatsapp_login_shared_secret|to_json }}
    # Maximum age of chats to sync in days.
    chat_sync_max_age: 0.5
    # Maximum number of messages to backfill for new portal rooms.
    initial_backfill_limit: 100

    # The prefix for commands. Only required in non-management rooms.
    command_prefix: "!im"

    # End-to-bridge encryption support options. This requires login_shared_secret to be configured
    # in order to get a device for the bridge bot.
    #
    # Additionally, https://github.com/matrix-org/synapse/pull/5758 is required if using a normal
    # application service.
    encryption:
        # Allow encryption, work in group chat rooms with e2ee enabled
        allow: false
        # Default to encryption, force-enable encryption in all portals the bridge creates
        # This will cause the bridge bot to be in private chats for the encryption to work properly.
        # It is recommended to also set private_chat_portal_meta to true when using this.
        default: false
        # Options for automatic key sharing.
        key_sharing:
            # Enable key sharing? If enabled, key requests for rooms where users are in will be fulfilled.
            # You must use a client that supports requesting keys from other users to use this feature.
            allow: false
            # Require the requesting device to have a valid cross-signing signature?
            # This doesn't require that the bridge has verified the device, only that the user has verified it.
            # Not yet implemented.
            require_cross_signing: false
            # Require devices to be verified by the bridge?
            # Verification by the bridge is not yet implemented.
            require_verification: true

# Logging config.
logging:
    # The directory for log files. Will be created if not found.
    directory: ./logs
    # Available variables: .Date for the file date and .Index for different log files on the same day.
    file_name_format: "{{ '{{.Date}}-{{.Index}}.log' }}"
    # Date format for file names in the Go time format: https://golang.org/pkg/time/#pkg-constants
    file_date_format: "2006-01-02"
    # Log file permissions.
    file_mode: 0600
    # Timestamp format for log entries in the Go time format.
    timestamp_format: "Jan _2, 2006 15:04:05"
    # Minimum severity for log messages.
    # Options: debug, info, warn, error, fatal
    print_level: debug
